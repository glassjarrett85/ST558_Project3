---
title: "ST558 Project 3 - EDA"
author: "Jarrett Glass"
format: html
---

```{r}
#| warning: false
#| message: false

# Required libraries and data sets are housed in helper.R for consistency across each page.
source("helper.R")
```

## Introduction

This exploratory analysis will be performed on the `Diabetes Health Indicators` Data set, available from kaggle.com. ([Click here for more information](https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset/?select=diabetes_binary_health_indicators_BRFSS2015.csv)) This is a data set of survey responses to a questionnaire distributed by the CDC. Including the response variable `Diabetes_binary`, there are 21 additional predictor variables recorded; however, this analysis will review the following variables:

+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Variable               | Description of Variable                                                                                                                    |
+========================+============================================================================================================================================+
| `Diabetes_binary`      | The status of diabetes for the respondent.\                                                                                                |
|                        | Levels: `Not Diabetic`, `Diabetic or Pre-Diabetic`                                                                                         |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `HighChol`             | Indicator variable for high cholesterol.\                                                                                                  |
|                        | Levels: `Yes`, `No`                                                                                                                        |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `BMI`                  | Recorded Body Mass Indices for individuals.                                                                                                |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `HeartDiseaseorAttack` | Indicator variable for whether or not someone has had coronary heart disease (CHD) or myocardial infarction (MI).\                         |
|                        | Levels: `Yes`, `No`                                                                                                                        |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `PhysActivity`         | Indicator variable capturing if someone has performed physical activity *outside of their job* within the last 30 days or not.\            |
|                        | Levels: `Some`, `None`                                                                                                                     |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `GenHlth`              | A categorical variable self-assessing general level of health.\                                                                            |
|                        | Levels: `Excellent`, `Very Good`, `Good`, `Fair`, `Poor`                                                                                   |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `PhysHlth`             | The number of days (within the last 30) of any physical injury or illness.\                                                                |
|                        | Response: Any number between 0 and 30, inclusive.                                                                                          |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `DiffWalk`             | An indicator variable recording any difficulty walking or or climbing up stairs.\                                                          |
|                        | Levels: `Yes`, `No`                                                                                                                        |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `Sex`                  | The sex of the respondent.\                                                                                                                |
|                        | Levels: `Male`, `Female`                                                                                                                   |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| `Age`                  | Five-year ranges of ages, into which the respondent is categorized.\                                                                       |
|                        | Levels: `18-24`, `25-29`, `30-34`, `35-39`, `40-44`, `45-49`, `50-54`, `55-59`, `60-64`, `65-69`, `70-74`, `75-79`, `80+`, or `Not given`. |
+------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+

Now that a subset of the original data set has been generated creating only the variables to be analyzed, some summary statistics will be generated for this. The first item to meaningfully evaluate will be whether there are any missing values for any of these variables.

```{r}
# Confirm the structure of the cleaned data frame
str(df)

# Evaluate any missing values across the columns
df |>
  summarize(across(everything(), ~ sum(is.na(.x)))) |>
  as.data.frame() |>
  kable()
```

This affirms that there are no missing values in our data set. The first interesting item will be to evaluate statistics of the numerical variables:

```{r}
# Straight statistics of numerical variables
df |>
  summarize(across(where(is.numeric), list(Mean=mean, Median=median, SD=sd), .names="{.col}_{.fn}")) |>
  pivot_longer(cols=everything(), names_to="Variable", values_to="Value") |>
  mutate(Variables = word(Variable, 1, sep="_"), Statistic=word(Variable, 2, sep="_")) |>
  pivot_wider(id_cols=Variables, names_from=Statistic, values_from=Value) |>
  kable()

# Now split out based on the Diabetes status
df |>
  group_by(Diabetes_binary) |>
  summarize(across(where(is.numeric), list(Mean=mean, Median=median, SD=sd), .names="{.col}_{.fn}")) |>
  pivot_longer(cols=BMI_Mean:PhysHlth_SD, names_to="Variable", values_to="Value") |>
  mutate(Variables = word(Variable, 1, sep="_"), Statistic=word(Variable, 2, sep="_")) |>
  pivot_wider(id_cols=c(Variables, Diabetes_binary), names_from=Statistic, values_from=Value) |>
  arrange(Variables)|>
  kable()

# Show plots of these variables, to evaluate skewness
ggplot(df, aes(x=BMI, fill=Diabetes_binary, after_stat(density))) +
  geom_histogram(bins=45) +
  labs(title="Frequency of BMI by Diabetic Status",
       x="BMI",
       y="Density",
       fill="Diabetes Status")

ggplot(df, aes(x=PhysHlth, fill=Diabetes_binary, after_stat(density))) +
  geom_histogram(bins=45) +
  labs(title="Frequency of BMI by Diabetic Status",
       x="Number of days (of last 30) with injury or illness",
       y="Density",
       fill="Diabetes Status")  
```

Visual demonstration of the `BMI` variable indicates slight left-skew, with longer right-tails in diabetic/pre-diabetic participants. Otherwise there is not an obvious 'tell' from this graph. The Graph of the `PhysHlth` variable indicates fairly similar distribution of responses, but there are more reported cases of illness or injury for all 30 days for those with diabetes, than those without.

[Click here for the Modeling page.](Modeling.html)
